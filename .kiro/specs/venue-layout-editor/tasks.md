# 実装計画

- [ ] 1. プロジェクト構造とコアインターフェースの設定












  - React TypeScriptプロジェクトの初期化とReact Konvaの依存関係追加
  - TypeScriptインターフェース定義（SVGData, TableObject, Position等）
  - 基本的なフォルダ構造の作成（components, types, utils）
  - _要件: 1.1, 2.1, 3.1_




- [ ] 2. SVG読み込み機能の実装







- [x] 2.1 SVGLoaderコンポーネントの作成






  - ファイル選択UIとSVGファイル読み込み機能の実装
  - SVG解析とBoundingBox計算ロジックの実装
  - エラーハンドリングとバリデーション機能の追加
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 2.2 SVGデータ処理ユーティリティの実装














































































  - SVG文字列解析とviewBox抽出機能の実装
  - 境界計算とスケール変換ユーティリティの作成
  - SVGレンダリング用のKonva互換データ変換
  - _要件: 1.2, 5.1, 5.2_

- [-] 3. 基本キャンバス機能の実装








- [x] 3.1 VenueCanvasコンポーネントの作成






































































  - React Konva StageとLayerの基本セットアップ
  - SVG背景表示機能の実装
  - キャンバスサイズとスケール管理の実装
  - _要件: 1.1, 1.2, 5.1_

- [x] 3.2 スケール管理システムの実装




































  - 1px=1mmスケール変換関数の実装
  - ズーム機能とスケール維持ロジックの追加
  - 測定値表示機能の実装
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [x] 4. テーブルオブジェクト機能の実装




- [x] 4.1 テーブル形状コンポーネントの作成


  - RectangleTableコンポーネント（Konva Rect使用）の実装
  - CircleTableコンポーネント（Konva Circle使用）の実装
  - テーブルスタイリングとビジュアル区別機能の追加
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [x] 4.2 テーブル作成機能の実装


  - TableToolbarコンポーネントの作成
  - テーブルタイプ選択とプロパティ設定UIの実装
  - 一意ID生成とテーブルオブジェクト作成ロジック
  - _要件: 2.1, 2.5_

- [x] 5. テーブル配置機能の実装




- [x] 5.1 テーブル配置システムの実装










  - クリック位置でのテーブル配置機能
  - 座標精度とレイヤー管理の実装
  - 配置成功の視覚的フィードバック機能
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [x] 5.2 複数テーブル管理の実装


  - テーブル状態管理とレンダリング最適化
  - テーブル選択とアクティブ状態の管理
  - レイヤー順序と視覚的競合防止機能
  - _要件: 3.3_

- [x] 6. ドラッグ＆ドロップ機能の実装




- [x] 6.1 基本ドラッグ機能の実装












  - Konvaドラッグイベントハンドリングの実装
  - リアルタイム位置更新とビジュアルフィードバック
  - ドラッグ状態管理とカーソル追従機能
  - _要件: 4.1, 4.2_

- [x] 6.2 ドラッグ完了処理の実装




  - ドロップ位置の確定とテーブル位置更新
  - 無効位置での元位置復帰機能
  - ドラッグ操作のコミット/ロールバック処理
  - _要件: 4.3, 4.4_

- [x] 7. 境界制約機能の実装











- [x] 7.1 境界チェックシステムの実装






















































  - テーブル境界とSVG境界の衝突検出
  - リアルタイム境界チェックとドラッグ制限
  - 境界外配置防止ロジックの実装
  - _要件: 6.1, 6.2_

- [x] 7.2 境界制約フィードバックの実装






  - 境界制約時の視覚的フィードバック機能
  - 無効位置でのスナップバック機能
  - 境界近接時の警告表示システム
  - _要件: 6.3, 6.4, 6.5_

- [x] 8. 状態管理とデータ永続化






- [x] 8.1 アプリケーション状態管理の実装




  - useReducerを使用した統合状態管理
  - テーブル操作の履歴管理（Undo/Redo）
  - 状態の正規化とパフォーマンス最適化
  - _要件: 2.5, 3.3_

- [x] 8.2 データ保存・読み込み機能の実装


  - レイアウトデータのJSON形式エクスポート
  - 保存されたレイアウトの読み込み機能
  - SVGとテーブルデータの統合保存
  - _要件: 全要件の統合_

- [ ] 9. エラーハンドリングとバリデーション




- [x] 9.1 包括的エラーハンドリングの実装
































  - SVG読み込みエラーの詳細処理
  - テーブル操作エラーのユーザーフレンドリー表示
  - 境界制約エラーの適切な処理
  - _要件: 1.4, 6.4_

- [x] 9.2 入力バリデーションの実装


















  - テーブルサイズと位置の妥当性チェック
  - SVGファイル形式とサイズ制限の実装
  - ユーザー入力の安全性検証
  - _要件: 1.4, 2.2, 2.3_

- [x] 10. テストとパフォーマンス最適化





- [x] 10.1 単体テストの実装



  - ユーティリティ関数のテスト（境界チェック、スケール変換）
  - コンポーネントの個別機能テスト
  - 状態管理ロジックのテスト
  - _要件: 全要件の品質保証_

- [x] 10.2 統合テストとE2Eテストの実装


  - SVG読み込みから配置までの完全フローテスト
  - ドラッグ＆ドロップ操作の統合テスト
  - 境界制約機能の動作テスト
  - _要件: 全要件の統合動作確認_