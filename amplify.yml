version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "=== Environment Info ==="
        - node --version
        - npm --version
        - echo "=== Current directory ==="
        - pwd
        - echo "=== Directory contents ==="
        - ls -la
        - echo "=== Installing dependencies ==="
        - npm ci
        - echo "=== Dependencies installed ==="
        - echo "=== Checking installed packages ==="
        - npm list --depth=0
    build:
      commands:
        - echo "=== Starting build process ==="
        - npm run lint || true
        - echo "=== Running build command ==="
        - CI=false npm run build
        - echo "=== Build completed ==="
        - ls -la dist/
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
  runtime:
    nodejs:
      version: 20
env:
  variables:
    CI: false
    NODE_ENV: production
    NODE_OPTIONS: "--max-old-space-size=4096"