# 会場レイアウトエディター

## 📋 プロジェクト概要

**プロジェクト名**: 会場レイアウトエディター  
**開発期間**: 2025年1月  
**技術スタック**: React 19 + TypeScript + Vite + Konva.js  
**目的**: SVG会場図面を使用した視覚的なテーブル配置システム

## 🎯 アプリケーションの特徴

### **コア機能**
実際の会場図面（SVG形式）を背景として、テーブルを視覚的に配置・管理できるWebアプリケーション

### **対象ユーザー**
- イベントプランナー
- 会場管理者
- ウェディングプランナー
- 展示会・会議の運営担当者

## ⚡ 主要機能

### 1. **SVG会場図の読み込み**
- **ドラッグ&ドロップ対応**: 直感的なファイル読み込み
- **完全SVG表示**: 壁、柱、ステージ、出入口などの詳細を背景表示
- **自動サイズ検出**: SVGの`width`、`height`、`viewBox`属性から会場サイズを自動取得
- **ファイル検証**: 形式チェック（.svg）、サイズ制限（10MB）

### 2. **テーブル作成・管理**
- **2種類のテーブル**: 長方形（幅×高さ指定）、円形（半径指定）
- **リアルタイム配置**: 作成と同時にキャンバス上に表示
- **プロパティ表示**: ID、タイプ、位置、サイズの詳細情報
- **視覚的選択**: クリックで選択、ハイライト表示

### 3. **高度な配置機能**

#### **ドラッグ&ドロップ移動**
- スムーズなマウス操作
- リアルタイム位置更新
- 境界制約との連動

#### **カスタム境界エリア設定**
- **マウスドラッグ設定**: 会場内の配置可能エリアを矩形で指定
- **視覚的フィードバック**: 緑の点線で境界エリアを表示
- **設定モード**: 専用モードでの直感的な境界設定

#### **厳密な境界制約**
- **リアルタイム制約**: ドラッグ中も境界を超えない
- **完全制約**: テーブルの一部も境界外に出ない
- **自動補正**: 境界外への移動を自動的に境界内に制限

### 4. **グリッドスナップシステム**
- **可変グリッドサイズ**: 100mm〜1000mm（100mm単位）
- **スナップ機能**: テーブルを格子点に自動吸着
- **グリッド表示**: 薄いグレー線でグリッドを可視化
- **選択的適用**: ドラッグ時のみスナップ、既存テーブルは影響なし

### 5. **ズーム・パン機能**
- **ズーム制御**: 10%〜300%の範囲でスライドバー調整
- **パン操作**: X・Y軸独立のスライドバー制御
- **リセット機能**: ワンクリックで初期表示に復帰
- **同期表示**: SVG背景とテーブルが同期してスケール

### 6. **右クリックメニュー**
- **コンテキストメニュー**: テーブル右クリックでメニュー表示
- **複製機能**: 選択テーブルを50mmオフセットで複製
- **削除機能**: 選択テーブルの即座削除
- **直感的操作**: アイコン付きメニューで分かりやすい操作

### 7. **エラーハンドリング**
- **ファイル検証**: 不正ファイルの検出と警告
- **ユーザーフレンドリー**: 日本語エラーメッセージ
- **自動回復**: エラー後の正常操作復帰

## 🏗️ 技術アーキテクチャ

### **フロントエンド技術**
- **React 19**: 最新のReactフレームワーク
- **TypeScript**: 型安全性とコード品質の向上
- **Vite**: 高速ビルドツール
- **React-Konva**: 2Dキャンバス描画ライブラリ

### **コンポーネント構成**
```
App.tsx (メインアプリケーション)
├── SVGLoader (ファイル読み込み)
├── BoundaryAreaSelector (境界エリア設定)
├── GridSnapControls (グリッド設定)
├── TableToolbar (テーブル作成)
├── EnhancedCanvas (メインキャンバス)
│   ├── ZoomPanControls (ズーム・パン)
│   └── ContextMenu (右クリックメニュー)
└── ErrorDisplay (エラー表示)
```

### **状態管理**
- **React Hooks**: useState, useEffect, useRef
- **カスタムフック**: useErrorHandler
- **型安全**: TypeScript型定義による厳密な型管理

### **データ構造**
```typescript
// SVGデータ
interface SVGData {
  content: string;
  width: number;
  height: number;
  viewBox: ViewBox;
  bounds: Bounds;
}

// テーブルオブジェクト
interface TableObject {
  id: string;
  type: 'rectangle' | 'circle';
  position: Position;
  properties: RectangleProps | CircleProps;
  style: TableStyle;
}

// 境界エリア
interface BoundaryArea {
  x: number;
  y: number;
  width: number;
  height: number;
}
```

## 🎨 ユーザーインターフェース

### **レスポンシブデザイン**
- **3カラムレイアウト**: ヘッダー、サイドバー、メインキャンバス
- **適応的表示**: 画面サイズに応じた最適化
- **直感的操作**: ドラッグ&ドロップ中心の操作体系

### **視覚的フィードバック**
- **選択ハイライト**: 黄色でテーブル選択を表示
- **境界エリア**: 緑の点線で配置可能エリアを表示
- **グリッド線**: 薄いグレーで格子を表示
- **ローディング表示**: SVG読み込み中の状態表示

## 📊 パフォーマンス特性

### **最適化機能**
- **効率的レンダリング**: Konva.jsによる高速2D描画
- **メモリ管理**: SVG画像の適切なメモリ解放
- **イベント最適化**: 不要なイベントリスナーの無効化

### **制限事項**
- **ファイルサイズ**: SVGファイル10MB以下
- **ブラウザ対応**: モダンブラウザ（ES2022対応）
- **同時テーブル数**: 実用的な範囲（〜100テーブル）

## 🔧 開発・運用

### **開発環境**
```bash
# 開発サーバー起動
npm run dev

# ビルド
npm run build

# テスト実行
npm run test
```

### **ディレクトリ構造**
```
venue-layout-editor/
├── src/
│   ├── components/     # Reactコンポーネント
│   ├── hooks/         # カスタムフック
│   ├── types/         # TypeScript型定義
│   ├── utils/         # ユーティリティ関数
│   └── test/          # テストファイル
├── public/            # 静的ファイル
└── dist/              # ビルド出力
```

## 🚀 実用性と拡張性

### **実用レベル**
- **業務利用可能**: 実際の会場設計業務で使用可能
- **精密配置**: mm単位での正確なテーブル配置
- **効率的操作**: 直感的なUI/UX設計

### **将来の拡張可能性**
- **データ永続化**: JSON形式での保存・読み込み
- **エクスポート機能**: PNG/PDF出力
- **Undo/Redo**: 操作履歴管理
- **印刷機能**: レイアウト図の印刷
- **テンプレート機能**: 定型レイアウトの保存

## 📈 プロジェクト成果

### **技術的成果**
- **モダン技術スタック**: React 19 + TypeScript + Viteの活用
- **高品質コード**: 型安全性とテスト可能性の確保
- **パフォーマンス**: 滑らかな操作感の実現

### **機能的成果**
- **包括的機能**: SVG読み込みからテーブル配置まで完結
- **使いやすさ**: 直感的な操作体系の実現
- **実用性**: 実際の業務で使用可能なレベル

## 🎮 使用方法

### **基本操作**
1. **SVGファイル読み込み**: ドラッグ&ドロップまたはファイル選択
2. **境界エリア設定**: 「境界エリア設定」モードでドラッグして範囲指定
3. **テーブル作成**: サイドバーでタイプ・サイズを指定して「追加」
4. **テーブル移動**: ドラッグ&ドロップで自由に配置
5. **グリッド活用**: グリッド表示・スナップ機能で整然とした配置

### **高度な操作**
- **右クリックメニュー**: テーブルの複製・削除
- **ズーム・パン**: 詳細確認や全体俯瞰
- **プロパティ確認**: テーブル選択で詳細情報表示

---

## 🚀 デプロイ

### AWS Amplifyでのデプロイ

このプロジェクトはAWS Amplifyでホストされています。

#### 自動デプロイ
- `main`ブランチへのプッシュで自動デプロイ
- ビルド設定: `amplify.yml`

#### 手動デプロイ
```bash
# ビルド
npm run build

# AWS Amplify Console でデプロイ
```

### 開発環境
```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# ビルド
npm run build

# テスト実行
npm run test
```

---

**開発完了日**: 2025年1月25日  
**総開発時間**: 約8時間  
**コード行数**: 約2,000行（TypeScript + CSS）  
**テストカバレッジ**: 主要機能の単体・統合テスト実装済み

このアプリケーションは、会場レイアウト設計の効率化と視覚化を実現する実用的なWebアプリケーションとして完成しました。