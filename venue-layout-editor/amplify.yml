version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "=== Environment Info ==="
        - node --version
        - npm --version
        - echo "=== Current directory ==="
        - pwd
        - echo "=== Directory contents ==="
        - ls -la
        - echo "=== Looking for venue-layout-editor directory ==="
        - find . -name "venue-layout-editor" -type d || echo "venue-layout-editor directory not found"
        - echo "=== Checking if package.json exists in venue-layout-editor ==="
        - test -f venue-layout-editor/package.json && echo "package.json found" || echo "package.json not found"
        - echo "=== Installing dependencies ==="
        - cd venue-layout-editor && npm install
    build:
      commands:
        - echo "=== Starting build process ==="
        - cd venue-layout-editor && npm run lint || true
        - echo "=== Running build command ==="
        - cd venue-layout-editor && CI=false npm run build
        - echo "=== Build completed ==="
        - ls -la venue-layout-editor/dist/
  artifacts:
    baseDirectory: venue-layout-editor/dist
    files:
      - '**/*'
  cache:
    paths:
      - venue-layout-editor/node_modules/**/*
  runtime:
    nodejs:
      version: 18
env:
  variables:
    CI: false
    NODE_ENV: production
    NODE_OPTIONS: "--max-old-space-size=4096"