# 要件ドキュメント

## 概要

この機能は、ユーザーがSVG会場図を読み込み、その上にテーブルオブジェクトを配置できるインタラクティブな会場レイアウトエディターを実装します。システムはReact Konvaを使用してキャンバスベースのインタラクションを提供し、テーブルの配置と移動にドラッグ＆ドロップ機能を提供します。エディターは会場境界外へのテーブル配置を防ぐ空間制約を適用し、正確なレイアウト計画のために1px=1mmの精密なスケーリングを使用します。

## 要件

### 要件1

**ユーザーストーリー:** 会場管理者として、SVGファイルを会場図として読み込みたい。これにより会場の物理的なレイアウトを視覚化できる。

#### 受け入れ基準

1. ユーザーがSVGファイルを選択したとき、システムはSVGを読み込み、キャンバスの背景レイヤーとして表示する
2. SVGが読み込まれたとき、システムは元のアスペクト比と寸法を維持する
3. SVGが複雑なグラフィックを含むとき、システムはReact Konvaキャンバス内ですべての視覚要素を正しくレンダリングする
4. SVGファイルが無効または破損している場合、システムは適切なエラーメッセージを表示する

### 要件2

**ユーザーストーリー:** 会場管理者として、長方形と円形のテーブルオブジェクトを作成したい。これにより会場レイアウトで異なるテーブルタイプを表現できる。

#### 受け入れ基準

1. ユーザーがテーブル追加を要求したとき、システムは長方形と円形のテーブル形状のオプションを提供する
2. 長方形テーブルが作成されたとき、システムは幅と高さの寸法のカスタマイズを許可する
3. 円形テーブルが作成されたとき、システムは半径のカスタマイズを許可する
4. テーブルオブジェクトが作成されたとき、システムは会場背景から明確に視覚的に区別して表示する
5. 複数のテーブルが作成されたとき、システムは各テーブルオブジェクトに一意の識別子を割り当てる

### 要件3

**ユーザーストーリー:** 会場管理者として、テーブルオブジェクトを会場図上に配置したい。これによりイベントの最適なレイアウトを計画できる。

#### 受け入れ基準

1. ユーザーがテーブルオブジェクトを作成したとき、システムは会場図上の任意の有効な位置への配置を許可する
2. テーブルが配置されたとき、システムはユーザーインタラクションで指定された正確な座標に配置する
3. 複数のテーブルが配置されたとき、システムはレイヤー順序を維持し、視覚的な競合を防ぐ
4. テーブルが配置されたとき、システムは配置成功を確認する視覚的フィードバックを提供する

### 要件4

**ユーザーストーリー:** 会場管理者として、ドラッグ＆ドロップを使用してテーブルオブジェクトを移動したい。これによりオブジェクトを再作成することなく簡単にレイアウトを調整できる。

#### 受け入れ基準

1. ユーザーがテーブルオブジェクトをクリックしてドラッグしたとき、システムはテーブルをカーソル位置に追従して移動する
2. テーブルがドラッグされているとき、システムは新しい位置のリアルタイム視覚フィードバックを提供する
3. ドラッグ操作が完了したとき、システムはテーブルの位置を最終的なドロップ位置に更新する
4. ユーザーがドラッグを離したとき、システムは新しい位置をコミットするか、無効な場合は元の位置に戻す

### 要件5

**ユーザーストーリー:** 会場管理者として、1px=1mmの精密なスケーリングが欲しい。これにより会場レイアウトの正確な実世界測定を作成できる。

#### 受け入れ基準

1. 会場図が表示されたとき、システムは1px = 1mmのスケール比を維持する
2. テーブル寸法が指定されたとき、システムは測定値を正しいピクセル寸法に変換する
3. ユーザーがオブジェクトと相互作用するとき、システムはユーザー参照用にミリメートル単位で測定値を表示する
4. キャンバスがズームされたとき、システムは正確な測定のためにスケール関係を維持する

### 要件6

**ユーザーストーリー:** 会場管理者として、会場境界外へのテーブル配置を防ぎたい。これによりすべてのテーブルが使用可能なスペース内に配置されることを保証できる。

#### 受け入れ基準

1. ユーザーが会場境界外にテーブルを配置しようとしたとき、システムは配置を防ぐ
2. ユーザーがテーブルを会場境界に向かってドラッグしたとき、システムは境界端で移動を停止する
3. テーブルが会場境界を超えて延びる場合、システムはテーブル全体を境界内に保つように位置を制約する
4. 境界制約が適用されたとき、システムは制約を示す視覚的フィードバックを提供する
5. ドラッグ中にテーブルが境界外に部分的に出た場合、システムはリリース時に最も近い有効な位置にスナップバックする